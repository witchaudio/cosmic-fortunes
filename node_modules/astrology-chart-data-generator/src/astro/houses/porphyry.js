import { normaliseDegree } from "../../utils/math";
import { convertToZodiacString } from "../utils";

export const calculatePorphyryHouses = ({
  ascendant,
  descendant,
  midheaven,
  lowerMidheaven,
}) => {
  const cusps = [];
  const A =
    Math.abs(
      lowerMidheaven - ascendant + (lowerMidheaven < ascendant ? 360 : 0)
    ) / 3;
  const B =
    Math.abs(
      descendant - lowerMidheaven + (descendant < lowerMidheaven ? 360 : 0)
    ) / 3;

  cusps.push(ascendant);
  cusps.push(ascendant + A);
  cusps.push(ascendant + 2 * A);
  cusps.push(lowerMidheaven);
  cusps.push(lowerMidheaven + B);
  cusps.push(lowerMidheaven + 2 * B);
  cusps.push(descendant);
  cusps.push(cusps[1] + 180);
  cusps.push(cusps[2] + 180);
  cusps.push(midheaven);
  cusps.push(cusps[4] + 180);
  cusps.push(cusps[5] + 180);
  return cusps.map((cusp) => ({
    degree: normaliseDegree(cusp),
    zodiacDegree: convertToZodiacString(cusp),
  }));
};
